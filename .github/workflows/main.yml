# Имя workflow
name: Run tests

# Событие, которое запускает workflow
on: push

# Задачи, которые выполняются параллельно
jobs:
  # Задача для runner'а ubuntu-latest
  test-ubuntu:
    # Имя runner'а
    runs-on: ubuntu-latest
    # Шаги, которые выполняются последовательно
    steps:
      # Установка Python
      - uses: actions/setup-python@v2
        with:
          python-version: 3.9
      # Клонирование репозитория
      - uses: actions/checkout@v2
      # Кэширование зависимостей
      - uses: actions/cache@v2
        with:
          path: ~/.cache/pip
          key: $ { { runner.os }}-pip-$ { { hashFiles('**/requirements.txt') }}
          restore-keys: |
            $ { { runner.os }}-pip-
      # Установка зависимостей
      - run: pip install -r requirements.txt
      # Запуск тестов
      - run: python tests.py

  # Задача для runner'а windows-latest
  test-windows:
    # Имя runner'а
    runs-on: windows-latest
    # Шаги, которые выполняются последовательно
    steps:
      # Установка Python
      - uses: actions/setup-python@v2
        with:
          python-version: 3.9
      # Клонирование репозитория
      - uses: actions/checkout@v2
      # Кэширование зависимостей
      - uses: actions/cache@v2
        with:
          path: ~\AppData\Local\pip\Cache
          key: $ { { runner.os }}-pip-$ { { hashFiles('**/requirements.txt') }}
          restore-keys: |
            $ { { runner.os }}-pip-
      # Установка зависимостей
      - run: pip install -r requirements.txt
      # Запуск тестов
      - run: python tests.py
